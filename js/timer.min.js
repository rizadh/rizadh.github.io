"use strict";function startupAnimation(){var e=GLOBAL_ANIMATION_DURATION,t=$("#display-text"),a=$("#display"),o=$("#keypad tr"),i=20;$.Velocity.hook(t,"translateY","-100%"),$.Velocity.hook(t,"opacity","0"),t.velocity({translateY:"-50%",opacity:1},{easing:GLOBAL_EASE_OUT,duration:e,delay:i}),$.Velocity.hook(a,"translateY","-100%"),$.Velocity.hook(a,"opacity","0"),a.velocity({translateY:0,opacity:1},{easing:GLOBAL_EASE_OUT,duration:e,delay:i}),$.Velocity.hook(o,"opacity","0"),$.Velocity.hook(o,"translateY","-10%"),$.Velocity.RegisterEffect("transition.slideIn",{calls:[[{translateY:0,opacity:1}]]}),o.velocity("transition.slideIn",{easing:GLOBAL_EASE_OUT,duration:e/2,delay:e/4+i,stagger:e/4/(o.length-1),drag:!0,display:null})}function setDial(e,t,a){var o=50,i=o-t,s=a>=.5?1:0,l=i+t*(1+Math.sin(2*Math.PI*a)),n=i+t*(1-Math.cos(2*Math.PI*a)),r=l+" "+n,c=t+" "+t,d=" 0 "+s+" 1 ",u="M"+o+" "+o,y="m0 "+-t,g="A"+c+d+r,p=u+y+g;e.attr("d",p)}function setTime(e,t){var a=$("#dial-ring path"),o=t?a.data("time_left"):1e3*e,i=t?a.data("progress"):0;a.velocity({tween:[WHOLE_CIRCLE,i]},{duration:o,easing:"linear",progress:function(e,t,o,i,s){setDial(a,40,s),a.data("progress",s),a.data("time_left",o);var l=Math.ceil(o/1e3),n=Math.floor(l/60)%60,r=Math.floor(l/3600),c=l%60;c=("0"+c).slice(-2),n=("0"+n).slice(-2),r=("0"+r).slice(-2);var d=[r,n,c];setDisplayTime(d.join(""),!1)},complete:function(){setDisplayTime("Done")}})}function getDisplayTime(e){var t=$("#display-text");return e?t.text():t.data("current_time")}function setDisplayTime(e,t){var a=$("#display-text");if(t)a.data("current_time","000000").text(e).css("font-family","roboto_condensedregular");else if(""===e)a.data("current_time","000000").text("Enter a time").css("font-family","roboto_condensedregular");else if("000000"===e)a.data("current_time","000000").text("0s").css("font-family","robotoregular");else if("Done"===e)a.data("current_time","000000").text(e).css("font-family","robotoregular");else if("Paused"===e)a.text(e).css("font-family","robotoregular");else if(a.data("current_time")!==e||"Paused"===a.text()){a.data("current_time",e).css("font-family","robotoregular");for(var o=getDisplayTime(),i=[],s=["h","m","s"],l=0;3>l;l++){var n=o.slice(2*l,2*l+2);(n>0||i[0]||2===l)&&(10>n&&!i[0]&&(n=n.slice(-1)),i.push(n+s[l]))}var r=i.join(" ");a.text(r)}}function startTimer(e){var t=getDisplayTime(),a=3600*t.slice(-6,-4),o=60*t.slice(-4,-2),i=1*t.slice(-2),s=a+o+i;if(36e4>s){var l=20;setTime(s,e),$("#display").data("input_mode",!1),$("#display").addClass("running"),e||($("#display").velocity("stop").velocity({height:"90%"},{duration:GLOBAL_ANIMATION_DURATION,easing:GLOBAL_EASE_OUT,delay:l}),$("#keypad").velocity("stop").velocity({translateY:"20%",opacity:0},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"none",delay:l}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"block",delay:l}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"block",delay:l}))}else setDisplayTime("Time too high",!0)}function editTime(){setDisplayTime(getDisplayTime()),$("#display").data("input_mode",!0).data("paused",!1),$("#display").removeClass("running"),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:GLOBAL_ANIMATION_DURATION,easing:GLOBAL_EASE_OUT}),$("#keypad").velocity("stop").velocity({translateY:0,opacity:1},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:GLOBAL_EASE_OUT,display:"none",duration:GLOBAL_ANIMATION_DURATION}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function togglePause(){$("#display").data("paused")?resumeTimer():pauseTimer()}function pauseTimer(){$("#dial-ring path").velocity("stop"),setDisplayTime("Paused"),$("#display").data("paused",!0)}function resumeTimer(){startTimer(!0),$("#display").data("paused",!1)}function toggleKeyboardHelp(e){var t=$("#keyboard-help");if(arguments.length>0)!!t.data("shown")==!e&&toggleKeyboardHelp();else{var a=!t.data("shown");t.data("shown",a).velocity("stop").velocity({scale:a?[1,0]:[0,1],opacity:a?[1,0]:[0,1]},{easing:a?GLOBAL_EASE_OUT:GLOBAL_EASE_IN,display:a?"block":"none",duration:a?GLOBAL_ANIMATION_DURATION:GLOBAL_ANIMATION_DURATION/4})}}function toggleKeyboardSuggest(e){console.log("Called");var t=$("#keyboard-suggest");if(arguments.length>0)console.log("Args"),!!t.data("shown")==!e&&(toggleKeyboardSuggest(),console.log("Going to state: "+e));else{console.log("No args");var a=!t.data("shown");a&&$.Velocity.hook(t,"translateY","-100%"),t.data("shown",a).velocity("stop").velocity({translateY:a?[0,"-100%"]:["-100%",0]},{easing:a?GLOBAL_EASE_OUT:GLOBAL_EASE_IN,display:a?"block":"none",duration:a?GLOBAL_ANIMATION_DURATION:GLOBAL_ANIMATION_DURATION/4})}}function hoverTouchUnstick(){if("ontouchstart"in document.documentElement)for(var e=document.styleSheets.length-1;e>=0;e--){var t=document.styleSheets[e];if(t.cssRules)for(var a=t.cssRules.length-1;a>=0;a--){var o=t.cssRules[a];o.selectorText&&(o.selectorText=o.selectorText.replace(":hover",":active"))}}}var WHOLE_CIRCLE=.99999,EASE_FUNC="Expo",GLOBAL_EASE_OUT="easeOut"+EASE_FUNC,GLOBAL_EASE_IN="easeIn"+EASE_FUNC,GLOBAL_ANIMATION_DURATION=400;$(function(){$.Velocity.hook($("#keyboard-help"),"translateX","-50%"),$.Velocity.hook($("#keyboard-help"),"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("#keyboard-help > .shortcut.delete > span").text("Delete"),hoverTouchUnstick(),$("#display").data("input_mode",!0),startupAnimation(),setDisplayTime(""),$("#keypad td").on("click",function(){var e=$(this).text();if("Clear"==e)setDisplayTime("000000");else if("Start"==e)startTimer();else{var t=(getDisplayTime()+e).slice(-6);setDisplayTime(t)}}),$("#edit-button").on("click",function(){editTime()}),$("#display-text").on("click",function(){$("#display").data("input_mode")||togglePause()}),$("#sure").on("click",function(){toggleKeyboardHelp(!0)}),$("#nope").on("click",function(){localStorage.setItem("mouse-suggested","temp")}),$("#keyboard-suggest .button").on("click",function(e){e.stopPropagation(),toggleKeyboardSuggest(!1)})}),$(document).on("keydown",function(e){var t=e.keyCode;switch(t){case 8:if(e.preventDefault(),$("#display").data("input_mode")){var a=("0"+getDisplayTime()).slice(-7,-1);setDisplayTime(a)}break;case 13:$("#display").data("input_mode")?startTimer():editTime();break;case 27:$("#display").data("input_mode")||editTime();break;case 32:$("#display").data("input_mode")?toggleKeyboardHelp():togglePause();break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if($("#display").data("input_mode")){var o=String.fromCharCode(t),i=(getDisplayTime()+o).slice(-6);setDisplayTime(i);break}}32!==t&&toggleKeyboardHelp(!1)}),$(document).on("touchstart",function(){localStorage.setItem("touch-device","true")}),$(document).on("click",function(){toggleKeyboardHelp(!1);var e=localStorage.getItem("touch-device"),t=localStorage.getItem("mouse-suggested"),a=sessionStorage.getItem("mouse-suggested");e||(t?"temp"===t&&(a||(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),toggleKeyboardSuggest(!0))):(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),toggleKeyboardSuggest(!0)))}),$(window).on("load resize orientationChange",function(){var e=Math.min($(window).height(),$(window).width());$("html").css("font-size",e/9)});