!function(){"use strict";function t(){var t=S,a=$("#display"),o=$("#display-text"),i=$("#keypad tr"),s=20;f("time").length?(n(("000000"+f("time")).slice(-6),!1,!0),$.Velocity.hook(a,"height","0"),$.Velocity.hook(a,"opacity","0"),$.Velocity.hook(a,"fontSize","0"),$.Velocity.hook($("#keypad"),"opacity","0"),l()):($.Velocity.hook(o,"translateY","-100%"),$.Velocity.hook(o,"opacity","0"),$.Velocity.hook(a,"translateY","-100%"),$.Velocity.hook(a,"opacity","0"),$.Velocity.hook(i,"opacity","0"),$.Velocity.hook(i,"translateY","-10%"),$.Velocity.RegisterEffect("transition.slideIn",{calls:[[{translateY:0,opacity:1}]]}),o.velocity({translateY:"-50%",opacity:1},{easing:x,duration:t,delay:s}),a.velocity({translateY:0,opacity:1},{easing:x,duration:t,delay:s,complete:e}),i.velocity("transition.slideIn",{easing:x,duration:t/2,delay:t/4+s,stagger:t/4/(i.length-1),drag:!0,display:null}))}function e(){var t=parseInt(localStorage.getItem("timeStarted")),e=parseInt(localStorage.getItem("durationSet"));if(t&&e){var a=t+e-(new Date).getTime(),o=10;a>1e3*o&&y("Seems like the timer was still running when you last closed this app. Do you want to restore the timer?",[{text:"No",style:"alert",clickFunction:function(){}},{text:"Sure",style:"emphasize",clickFunction:function(a){var o=t+e-(new Date).getTime(),i=1-o/e;o>0?($("#dial-ring path").data("timeLeft",o),$("#dial-ring path").data("progress",i),l(!1,!0)):(a.stopPropagation(),y("Too late, the timer has already ended",[{text:"Dismiss",style:"normal",clickFunction:function(){}}]))}}])}}function a(t,e,a){var o=50,i=o-e,n=a>=.5?1:0,s=i+e*(1+Math.sin(2*Math.PI*a)),l=i+e*(1-Math.cos(2*Math.PI*a)),c=s+" "+l,r=e+" "+e,d=" 0 "+n+" 1 ",p="M"+o+" "+o,u="m0 "+-e,y="A"+r+d+c,h=p+u+y;t.attr("d",h)}function o(t,e){var o=$("#dial-ring path"),i=e?o.data("timeLeft"):1e3*t,s=e?o.data("progress"):0;o.velocity("stop").velocity({tween:[v,s]},{duration:i,easing:"linear",begin:function(){localStorage.setItem("timeStarted",(new Date).getTime()),localStorage.setItem("durationSet",i)},progress:function(t,e,i,s,l){a(o,40,l),o.data("progress",l),o.data("timeLeft",i);var c=Math.ceil(i/1e3),r=Math.floor(c/60)%60,d=Math.floor(c/3600),p=c%60;p=("0"+p).slice(-2),r=("0"+r).slice(-2),d=("0"+d).slice(-2);var u=[d,r,p];0!==i&&n(u.join(""),!1,!0)},complete:function(){n("Done",!1,!0),$("#display").removeClass("running"),localStorage.setItem("timeStarted",0),localStorage.setItem("durationSet",0)}})}function i(t){var e=$("#display-text");return t?e.text():e.data("currentTime")}function n(t,e,a){var o=$("#display-text"),i=o.clone(!0);if(e)i.data("currentTime","000000").text(t).css("font-family","roboto_condensedregular"),g(i,a?"fancy":"");else if(""===t)o.data("currentTime","000000").text("Enter a time").css("font-family","roboto_condensedregular");else if("000000"===t)i.data("currentTime","000000").text("0s").css("font-family","robotoregular"),g(i,a?"fancy":"");else if("Done"===t)i.data("currentTime","000000").text(t).css("font-family","robotoregular"),g(i,a?"fancy":"");else if("Paused"===t)i.text(t).css("font-family","robotoregular"),g(i,a?"fancy":"");else if(o.data("currentTime")!==t||"Paused"===o.text()){i.data("currentTime",t).css("font-family","robotoregular");for(var n=[],s=["h","m","s"],l=0;3>l;l++){var c=t.slice(2*l,2*l+2);(c>0||n[0]||2===l)&&(10>c&&!n[0]&&(c=c.slice(-1)),n.push(c+s[l]))}var r=n.join(" ");i.text(r),g(i,a?"fancy":"")}}function s(t){var e=(i()+t).slice(-6);n(e)}function l(t,e){var a=i(),s=3600*a.slice(-6,-4),l=60*a.slice(-4,-2),c=1*a.slice(-2),r=s+l+c;if(0!==r||t||e)if(36e4>r||e||t){var d=20;o(r,t||e),$("#display").data("inputMode",!1),$("#display").addClass("running"),t||($("#display").velocity("stop").velocity({height:"90%",opacity:1,fontSize:"1em"},{duration:S,easing:x,delay:d}),$("#keypad").velocity("stop").velocity({translateY:"20%",opacity:0},{easing:x,duration:S,display:"none",delay:d}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:x,duration:S,display:"block",delay:d}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:x,duration:S,display:"block",delay:d}))}else n("Time too high",!0,!0);else n("No time entered",!0,!0)}function c(){n(i(),!1,!0),$("#display").data("inputMode",!0).data("paused",!1),$("#display").removeClass("running"),localStorage.setItem("timeStarted",0),localStorage.setItem("durationSet",0),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:S,easing:x}),$("#keypad").velocity("stop").velocity({translateY:0,opacity:1},{easing:x,duration:S,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:x,display:"none",duration:S}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function r(){$("#display").data("inputMode")||($("#display").data("paused")?p():d())}function d(){var t=$("#dial-ring path").attr("class"),e=~t.indexOf("velocity-animating");e&&($("#dial-ring path").velocity("stop"),n("Paused",!1,!0),$("#display").data("paused",!0),$("#dial-ring").velocity("stop").velocity({opacity:.25},{easing:x,duration:S}))}function p(){l(!0),$("#display").data("paused",!1),$("#dial-ring").velocity("stop").velocity({opacity:1},{easing:x,duration:S})}function u(t){var e=$("#keyboard-help");if(arguments.length>0)!!e.data("shown")==!t&&u();else{var a=!e.data("shown");e.data("shown",a).velocity("stop").velocity({scale:a?[1,0]:[0,1],opacity:a?[1,0]:[0,1]},{easing:a?x:b,display:a?"block":"none",duration:a?S:S/4})}}function y(t,e){for(var a=$("#notification-banner span").text(t),o=a.siblings("div").empty(),i=e.length-1;i>=0;i--){var n=e[i];$("<div></div>").text(n.text).addClass(n.style+" button").click(n.clickFunction).prependTo(o)}a.parent().velocity("stop").velocity({translateY:a.parent().data("shown")?0:[0,"-100%"]},{easing:x,display:"block",duration:S}).data("shown",!0)}function h(){$("#notification-banner").data("shown",!1).velocity("stop").velocity({translateY:"-100%"},{easing:b,display:"none",duration:S/4})}function g(t,e){$("#display-text-old").remove();var a=$("#display-text");if("fancy"===e){var o=a.text(),i=t.text(),n=[],s=[];if(o.length===i.length)for(var l=0;l<o.length;l++)o[l]===i[l]?(n.push(o[l]),s.push(i[l])):(n.push("<span>"),n.push(o[l]),n.push("</span>"),s.push("<span>"),s.push(i[l]),s.push("</span>"));else n.push("<span>"),n.push(o),n.push("</span>"),s.push("<span>"),s.push(i),s.push("</span>");var c=/<\/span><span>/gi;a.attr("id","display-text-old").html(n.join("").replace(c,"")).children("span").velocity({opacity:0,scale:.5},{easing:x,duration:S,queue:!1,display:"inline-block",complete:function(){$(this).parent().remove()}}),t.html(s.join("").replace(c,"")).appendTo("#display").children("span").css("opacity",0).velocity({opacity:[1,0],scale:[1,.5]},{easing:x,duration:S,queue:!1,display:"inline-block"})}else a.remove(),t.appendTo("#display")}function m(){if("ontouchstart"in document.documentElement)for(var t=document.styleSheets.length-1;t>=0;t--){var e=document.styleSheets[t];if(e.cssRules)for(var a=e.cssRules.length-1;a>=0;a--){var o=e.cssRules[a];o.selectorText&&(o.selectorText=o.selectorText.replace(":hover",":active"))}}}function f(t,e){e=e?e:window.location.search;var a=new RegExp("&amp;"+t+"=([^&amp;]*)","i");return e=(e=e.replace(/^\?/,"&amp;").match(a))?e[1]:""}var v=.99999,k="Expo",x="easeOut"+k,b="easeIn"+k,S=400;$(function(){FastClick.attach(document.body),$.Velocity.hook($("#keyboard-help"),"translateX","-50%"),$.Velocity.hook($("#keyboard-help"),"translateY","-50%"),$.Velocity.hook($("#display-text"),"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("#keyboard-help > .shortcut.delete > span").text("Delete"),window.navigator.standalone&&$(document).on("touchmove",!1),m(),$("#display").data("inputMode",!0),t(),n(""),$("#keypad td").click(function(){var t=$(this).text();"Clear"==t?n("000000"):"Start"==t?l():s(t)}),$("#edit-button").click(c),$("#display-text").click(r),$("#notification-banner").click(function(t){t.stopPropagation(),h()}),$(document).on("keydown",function(t){var e=t.keyCode;switch(e){case 8:if(t.preventDefault(),$("#display").data("inputMode")){var a=("0"+i()).slice(-7,-1);n(a)}break;case 13:$("#display").data("inputMode")?l():c();break;case 27:$("#display").data("inputMode")||c();break;case 32:$("#display").data("inputMode")?u():r();break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if($("#display").data("inputMode")){var o=String.fromCharCode(e);s(o);break}}32!==e&&u(!1)}),$(document).on("touchstart",function(){localStorage.setItem("touch-device","true")}),$(document).click(function(){u(!1);var t=localStorage.getItem("touch-device"),e=localStorage.getItem("mouse-suggested"),a=sessionStorage.getItem("mouse-suggested"),o="temp"===e,i=o&&!a;t||e&&!i||(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),y("Seems like you have a keyboard. Want to learn a few shortcuts?",[{text:"Never",style:"alert",clickFunction:function(){}},{text:"Not right now",style:"normal",clickFunction:function(){localStorage.setItem("mouse-suggested","temp")}},{text:"Yes, show me",style:"emphasize",clickFunction:function(){u(!0)}}]))}),$(window).on("load resize orientationChange",function(){var t=Math.min($(window).height(),$(window).width());$("html").css("font-size",t/9)})})}();