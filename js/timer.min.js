"use strict";function displayTime(){return $("#display-text").data("currentTime")}function validTimeString(a){var b=3600*a.slice(-6,-4),c=60*a.slice(-4,-2),d=1*a.slice(-2),e=b+c+d;return e>0&&36e4>e}function setDisplayTime(a,b){var c=!1,d="",e="1rem",f="",g=$("#display-text"),h=g.clone(!0).attr("id","display-text-old");switch(a){case"000000":case"":a="0s";case"Done":f="000000";case"Paused":d=a,c=!0;break;default:if(g.data("currentTime")!==a||"Paused"===g.text()){for(var i=[],j=["h","m","s"],k=0;3>k;k++){var l=a.slice(2*k,2*k+2);(l>0||i[0]||2===k)&&(10>l&&!i[0]&&(l=l.slice(-1)),i.push(l+j[k]))}var m=i.join(" ");if(.9*windowHeight>windowWidth&&m.length>8){if(1.5*windowWidth>windowHeight){var n=1/.9,o=1.5,p=windowHeight/windowWidth,q=(o-p)/(o-n);e=8/m.length*(1-q)+q}else e=8/m.length;e+="rem"}f=a,d=m,c=!0}}if(c)if($("#display-text-old").remove(),"crossfade"===b){var r=g.text(),s=d,t="",u="";if(r.length===s.length)for(var k=0;k<r.length;k++)r[k]===s[k]?(t+=r[k],u+=s[k]):(t+="<span>"+r[k]+"</span>",u+="<span>"+s[k]+"</span>");else t="<span>"+r+"</span>",u="<span>"+s+"</span>";var v=/<\/span><span>/gi;h.html(t.replace(v,"").replace(" ","&nbsp;")).children("span").velocity({opacity:[0,1],scale:.5},{easing:EASE_OUT,duration:Math.min(ANIMATION_DURATION,1e3),queue:!1,display:"inline-block",complete:function(){$(this).parent().remove()}}).end().prependTo(g.parent()),g.data("currentTime",f).html(u.replace(v,"").replace(" ","&nbsp;")).css({fontFamily:"robotoregular"}).children("span").css("opacity",0).velocity({opacity:1,scale:[1,.5]},{easing:EASE_OUT,duration:Math.min(ANIMATION_DURATION,1e3),queue:!1,display:"inline-block",complete:function(){$(this).contents().unwrap()}}),g.add(h).velocity({fontSize:e},{easing:[100,10],duration:ANIMATION_DURATION,queue:!1})}else g.data("currentTime",f).css({fontFamily:"robotoregular",fontSize:e}).html(d)}function addDigit(a){var b=(displayTime()+a).slice(-6);setDisplayTime(b)}function startTimer(a,b){var c=$("#display"),d=c.find("#display-text"),e=displayTime(),f=3600*e.slice(-6,-4),g=60*e.slice(-4,-2),h=1*e.slice(-2),i=f+g+h;$.Velocity.hook(d,"translateY","-50%"),0!==i||a||b?36e4>i||b||a?(setTime(i,a||b),c.data("inputMode",!1).addClass("running"),a||(c.velocity("stop").velocity({height:"90%",translateY:0},{duration:ANIMATION_DURATION,easing:EASE_OUT}),$("#keypad").velocity("stop").velocity({translateY:"10%",opacity:0},{easing:EASE_OUT,duration:ANIMATION_DURATION,display:"none"}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:EASE_OUT,duration:ANIMATION_DURATION,display:"block"}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:EASE_OUT,duration:ANIMATION_DURATION,display:"block"}))):(showNotification("The time entered was too high. Enter a time less than 100 hours"),setDisplayTime("")):showNotification("Please enter a time first")}function setTime(a,b){var c=$("#dial-ring path"),d=b?c.data("timeLeft"):1e3*a,e=b?c.data("progress"):0;c.velocity("stop").velocity({tween:[WHOLECIRCLE,e]},{duration:d,easing:"linear",begin:function(){localStorage.setItem("timeStarted",(new Date).getTime()),localStorage.setItem("durationSet",d)},progress:function(a,b,d,e,f){setDial(c,40,f),c.data("progress",f),c.data("timeLeft",d);var g=Math.ceil(d/1e3),h=Math.floor(g/60)%60,i=Math.floor(g/3600),j=g%60;j=("0"+j).slice(-2),h=("0"+h).slice(-2),i=("0"+i).slice(-2);var k=[i,h,j];0!==d&&setDisplayTime(k.join(""),"crossfade")},complete:function(){setDisplayTime("Done","crossfade"),$("#display").removeClass("running"),localStorage.setItem("timeStarted",0),localStorage.setItem("durationSet",0)}})}function setDial(a,b,c){var d=50,e=d-b,f=c>=.5?1:0,g=e+b*(1+Math.sin(2*Math.PI*c)),h=e+b*(1-Math.cos(2*Math.PI*c)),i=g+" "+h,j=b+" "+b,k=" 0 "+f+" 1 ",l="M"+d+" "+d,m="m0 "+-b,n="A"+j+k+i,o=l+m+n;a.attr("d",o)}function editTime(){var a=$("#display");setDisplayTime(displayTime(),"crossfade"),a.data("inputMode",!0).data("paused",!1).removeClass("running"),localStorage.setItem("timeStarted",0),localStorage.setItem("durationSet",0),$("#dial-ring path").velocity("stop"),a.velocity("stop").velocity({height:"20%"},{duration:ANIMATION_DURATION,easing:EASE_OUT}),$("#keypad").velocity("stop").velocity({translateY:0,opacity:1},{easing:EASE_OUT,duration:ANIMATION_DURATION,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:EASE_OUT,display:"none",duration:ANIMATION_DURATION}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function togglePause(){var a=$("#display");a.data("inputMode")||(a.data("paused")?(startTimer(!0),a.data("paused",!1),$("#dial-ring").velocity("stop").velocity({opacity:1},{easing:EASE_OUT,duration:ANIMATION_DURATION})):a.hasClass("running")?($("#dial-ring path").velocity("stop"),setDisplayTime("Paused","crossfade"),a.data("paused",!0),$("#dial-ring").velocity("stop").velocity({opacity:.25},{easing:EASE_OUT,duration:ANIMATION_DURATION})):editTime())}function toggleKeyboardHelp(a){var b=$("#keyboard-help");if(0===arguments.length){var c=!b.data("shown");b.data("shown",c).velocity("stop").velocity({scaleY:c?[1,0]:[0,1],scaleX:c?[1,.5]:[.5,1],opacity:c?[1,0]:[0,1]},{easing:c?EASE_OUT:EASE_IN,display:c?"block":"none",duration:c?ANIMATION_DURATION:ANIMATION_DURATION/2})}else!!b.data("shown")==!a&&toggleKeyboardHelp()}function showNotification(a,b){var c=$("#notification-banner span").text(a),d=c.siblings("div").empty();if(b){$("#content").css("pointer-events","none");for(var e=b.length-1;e>=0;e--){var f=b[e];$("<div></div>").text(f.text).addClass(f.style+" button").click(f.clickFunction).prependTo(d)}}else clearTimeout(c.data("hideTimeout")),c.data("hideTimeout",setTimeout(hideNotification,5e3));c.parent().velocity("stop").velocity({translateY:c.parent().data("shown")?0:[0,"-100%"]},{easing:EASE_OUT,display:"block",duration:ANIMATION_DURATION,complete:function(){b?$("#content").on("click.bannerhide",hideNotification):$(document).on("click.bannerhide",hideNotification)}}).data("shown",!0)}function hideNotification(){var a=$("#content"),b=$("#notification-banner");$(document).off("click.bannerhide",hideNotification),a.off("click.bannerhide",hideNotification).css("pointer-events",""),b.data("shown")&&$("#notification-banner").data("shown",!1).velocity("stop").velocity({translateY:"-100%"},{easing:EASE_IN,display:"none",duration:ANIMATION_DURATION/2})}function hoverTouchUnstick(){if("ontouchstart"in document.documentElement)for(var a=document.styleSheets.length-1;a>=0;a--){var b=document.styleSheets[a];if(b.cssRules)for(var c=b.cssRules.length-1;c>=0;c--){var d=b.cssRules[c];d.selectorText&&(d.selectorText=d.selectorText.replace(":hover",":active"))}}}function GET(a,b){b=b?b:window.location.search;var c=new RegExp("&amp;"+a+"=([^&amp;]*)","i");return b=(b=b.replace(/^\?/,"&amp;").match(c))?b[1]:""}function isSupportedCSS(a){return a in document.body.style}var WHOLECIRCLE=.99999,EASEFUNC="Expo",EASE_OUT="easeOut"+EASEFUNC,EASE_IN="easeIn"+EASEFUNC,ANIMATION_DURATION=300,windowWidth,windowHeight;$(function(){var a=$("#display"),b=$("#display-text"),c=$("#keypad"),d=$("#keyboard-help");FastClick.attach(document.body),$.Velocity.hook(d,"translateX","-50%"),$.Velocity.hook(d,"translateY","-50%"),$.Velocity.hook(b,"translateX","-50%"),$.Velocity.hook(b,"translateY","-50%"),$.Velocity.hook(c,"translateX","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&d.find(".delete").text("Delete"),window.navigator.standalone&&$(document).on("touchmove",!1),hoverTouchUnstick(),(isSupportedCSS("-webkit-backdrop-filter")||isSupportedCSS("-moz-backdrop-filter")||isSupportedCSS("-o-backdrop-filter")||isSupportedCSS("-ms-backdrop-filter")||isSupportedCSS("backdrop-filter"))&&$("body").addClass("backdrop-filter"),a.data("inputMode",!0),$.Velocity.hook(a,"translateY","-100%"),c.css("opacity",0);var e=GET("time");if(validTimeString(e))setDisplayTime(("000000"+e).slice(-6)),a.css("height","90%"),startTimer();else{$.Velocity.hook(c,"translateY","20%"),$.Velocity.hook(b,"translateY","-100%");var f=1.5*ANIMATION_DURATION;c.velocity({opacity:1,translateY:0},{easing:EASE_OUT,duration:f}),b.velocity({translateY:"-50%",rotateX:0},{easing:EASE_OUT,duration:f}),a.velocity({translateY:0},{easing:EASE_OUT,duration:f,complete:function(){function a(){return b+c-(new Date).getTime()}var b=parseInt(localStorage.getItem("timeStarted")),c=parseInt(localStorage.getItem("durationSet"));if(b&&c){var d=5;if(a()>1e3*d){var e="Seems like the timer was still running when you last closed this app. Do you want to restore the timer?",f={text:"No",style:"alert",clickFunction:function(){localStorage.setItem("timeStarted","0"),localStorage.setItem("durationSet","0")}},g={text:"Sure",style:"emphasize",clickFunction:function(){var b=1-a()/c;a()>0?($("#dial-ring path").data("timeLeft",a()).data("progress",b),startTimer(!1,!0)):showNotification("Too late, the timer has already ended")}};showNotification(e,[f,g])}}}})}b.data("currentTime","000000"),c.on("click","td",function(){var a=$(this).text();"Clear"===a?setDisplayTime(""):"Start"===a?startTimer():addDigit(a)}),$("#edit-button").click(editTime),a.on("click","#display-text",togglePause),$("#notification-banner").on("click",".button",hideNotification),$(document).on("keydown",function(a){var b=$("#notification-banner"),c=a.keyCode;if(b.data("shown")){if(""!==b.find("div").text()){switch(c){case 13:b.find(".emphasize").click();break;case 27:b.find(".alert").click()}return!1}hideNotification()}switch(c){case 8:if(a.preventDefault(),$("#display").data("inputMode")){var d=("0"+displayTime()).slice(-7,-1);setDisplayTime(d)}break;case 13:$("#display").data("inputMode")?startTimer():editTime();break;case 27:$("#display").data("inputMode")||editTime();break;case 32:$("#display").data("inputMode")?toggleKeyboardHelp():togglePause();break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if($("#display").data("inputMode")){var e=String.fromCharCode(c);addDigit(e);break}}32!==c&&toggleKeyboardHelp(!1)}),$(document).on("touchstart",function(){localStorage.setItem("touch-device","true")}),$(document).click(function(a){$(a.target).hasClass("button")||toggleKeyboardHelp(!1);var b=localStorage.getItem("touch-device"),c=localStorage.getItem("mouse-suggested"),d=sessionStorage.getItem("mouse-suggested"),e="temp"===c,f=e&&!d;b||c&&!f||(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),showNotification("Seems like you have a keyboard. Want to learn a few shortcuts?",[{text:"Never",style:"alert",clickFunction:function(){}},{text:"Not right now",style:"normal",clickFunction:function(){localStorage.setItem("mouse-suggested","temp")}},{text:"Yes, show me",style:"emphasize",clickFunction:function(){toggleKeyboardHelp(!0)}}]))}),$(window).on("load resize orientationChange",function(){var a=$(window);windowWidth=a.width(),windowHeight=a.height();var b=Math.min(1.5*windowWidth,windowHeight);$("html").css("font-size",b/9)})});
//# sourceMappingURL=timer.min.js.map