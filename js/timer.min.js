"use strict";function startupAnimation(){var e=400;$("#display-text").velocity({translateY:["-50%","-100%"]},{easing:"easeOutExpo",duration:2*e}),$("#display").velocity({translateY:[0,"-100%"]},{easing:"easeOutExpo",duration:2*e}),$.Velocity.hook($("#keypad td"),"scale","0"),$.Velocity.hook($("#keypad td"),"opacity","0"),$.Velocity.RegisterEffect("transition.pop",{calls:[[{scale:[1,0],opacity:[1,0]}]]});var t=!0;$("#keypad td").velocity(t?"transition.pop":{scale:[1,0]},{easing:"easeOutExpo",duration:e/2,delay:e/2,stagger:e/2/9,drag:!0})}function setDial(e,t,a){var i=a>=.5?1:0,o=t*(1+Math.sin(2*Math.PI*a)),s=t*(1-Math.cos(2*Math.PI*a)),l=o+" "+s,n=t+" "+t,r=" 0 "+i+" 1 ",c="M"+t+" "+t,d="L"+t+" 0",p="A"+n+r+l,y=c+d+p;e.attr("d",y)}function setTime(e){var t=1e3*e;$("#dial-ring path").velocity({tween:WHOLE_CIRCLE},{duration:t,easing:"linear",progress:function(e,t,a,i,o){setDial($("#dial-ring path"),50,o);var s=Math.ceil(a/1e3),l=Math.floor(s/60)%60,n=Math.floor(s/3600);s%=60,s=("0"+s).slice(-2),l=("0"+l).slice(-2),n=("0"+n).slice(-2);var r=[n,l,s];setDisplayTime(r.join(""),!1)}})}function getDisplayTime(e){var t=$("#display-text");return e?t.text():t.data("current_time")}function setDisplayTime(e,t){var a=$("#display-text");if(t)a.text(e).css("font-family","roboto_condensedregular");else if(""===e)a.data("current_time","000000").text("Enter a time").css("font-family","roboto_condensedregular");else{a.data("current_time",e).css("font-family","robotoregular");for(var i=getDisplayTime(),o=[],s=["h","m","s"],l=0;3>l;l++){var n=i.slice(2*l,2*l+2);(n>0||o[0]||2==l)&&(10>n&&!o[0]&&(n=n.slice(-1)),o.push(n+s[l]))}var r=o.join(" ");r!=a.text()&&a.text(r)}}function startTimer(){$("#display").data("input_mode",!1),$("#display").velocity("stop").velocity({translateY:0,height:"90%"},{duration:400,easing:"easeOutExpo"}),$("#keypad").velocity("stop").velocity({translateY:"10%",opacity:0},{easing:"easeOutExpo",duration:400,display:"none"}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:"easeOutExpo",duration:400,display:"block"}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:"easeOutExpo",duration:400,display:"block"});var e=getDisplayTime(),t=3600*e.slice(-6,-4),a=60*e.slice(-4,-2),i=1*e.slice(-2),o=t+a+i;setTime(o)}function editTime(){$("#display").data("input_mode",!0),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:400,easing:"easeOutExpo"}),$("#keypad").velocity("stop").velocity({translateY:0,opacity:1},{easing:"easeOutExpo",duration:400,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:"easeOutExpo",display:"none",duration:400}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function toggleKeyboardHelp(e){var t=$("#keyboard-help");if(e)t.data("shown")&&toggleKeyboardHelp();else{var a;a=t.data("shown")?!1:!0,t.data("shown",a).velocity("stop").velocity({scale:a?[1,0]:[0,1],opacity:a?[1,0]:[0,1]},{easing:"easeOutExpo",display:a?"block":"none",duration:400})}}function hoverTouchUnstick(){if("ontouchstart"in document.documentElement)for(var e=document.styleSheets.length-1;e>=0;e--){var t=document.styleSheets[e];if(t.cssRules)for(var a=t.cssRules.length-1;a>=0;a--){var i=t.cssRules[a];i.selectorText&&(i.selectorText=i.selectorText.replace(":hover",":active"))}}}var WHOLE_CIRCLE=.99999999;$(function(){$.Velocity.hook($("#keyboard-help"),"translateX","-50%"),$.Velocity.hook($("#keyboard-help"),"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("#keyboard-help > .shortcut.delete > span").text("Delete"),hoverTouchUnstick(),$("#display").data("input_mode",!0),startupAnimation(),setDisplayTime(""),$("#keypad td").on("tap",function(){var e=$(this).text();if("Clear"==e)setDisplayTime("000000");else if("Start"==e)startTimer();else{var t=(getDisplayTime()+e).slice(-6);setDisplayTime(t)}}),$("#edit-button").on("tap",function(){editTime()}),$("#keyboard-help").on("tap",function(){toggleKeyboardHelp(!0)}),$(document).on("keydown",function(e){var t=e.keyCode;if(t>=48&&57>=t&&$("#display").data("input_mode")){var a=String.fromCharCode(t),i=(getDisplayTime()+a).slice(-6);setDisplayTime(i)}else if(13==t)$("#display").data("input_mode")?startTimer():editTime();else if(8==t){if(e.preventDefault(),$("#display").data("input_mode")){var o=("0"+getDisplayTime()).slice(-7,-1);setDisplayTime(o)}}else 32==t&&toggleKeyboardHelp()})}),$(window).on("load resize orientationChange",function(){var e=Math.min(window.innerHeight,window.innerWidth);$("html").css("font-size",e/9)});