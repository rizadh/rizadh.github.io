"use strict";function startupAnimation(){var e=GLOBAL_ANIMATION_DURATION,t=$("#display-text"),a=$("#display"),i=$("#keypad tr"),s=20;$.Velocity.hook(t,"translateY","-100%"),$.Velocity.hook(t,"opacity","0"),t.velocity({translateY:"-50%",opacity:1},{easing:GLOBAL_EASE_OUT,duration:e,delay:s}),$.Velocity.hook(a,"translateY","-100%"),$.Velocity.hook(a,"opacity","0"),a.velocity({translateY:0,opacity:1},{easing:GLOBAL_EASE_OUT,duration:e,delay:s}),$.Velocity.hook(i,"opacity","0"),$.Velocity.hook(i,"translateY","-10%"),$.Velocity.RegisterEffect("transition.slideIn",{calls:[[{translateY:0,opacity:1}]]}),i.velocity("transition.slideIn",{easing:GLOBAL_EASE_OUT,duration:e/2,delay:e/4+s,stagger:e/4/(i.length-1),drag:!0,display:null})}function setDial(e,t,a){var i=50,s=i-t,o=a>=.5?1:0,l=s+t*(1+Math.sin(2*Math.PI*a)),n=s+t*(1-Math.cos(2*Math.PI*a)),c=l+" "+n,r=t+" "+t,d=" 0 "+o+" 1 ",p="M"+i+" "+i,u="m0 "+-t,y="A"+r+d+c,g=p+u+y;e.attr("d",g)}function setTime(e,t){var a=$("#dial-ring path"),i=t?a.data("time_left"):1e3*e,s=t?a.data("progress"):0;a.velocity({tween:[WHOLE_CIRCLE,s]},{duration:i,easing:"linear",progress:function(e,t,i,s,o){setDial(a,40,o),a.data("progress",o),a.data("time_left",i);var l=Math.ceil(i/1e3),n=Math.floor(l/60)%60,c=Math.floor(l/3600),r=l%60;r=("0"+r).slice(-2),n=("0"+n).slice(-2),c=("0"+c).slice(-2);var d=[c,n,r];0!==i&&setDisplayTime(d.join(""),!1,!0)},complete:function(){setDisplayTime("Done")}})}function getDisplayTime(e){var t=$("#display-text");return e?t.text():t.data("current_time")}function setDisplayTime(e,t,a){var i=$("#display-text"),s=i.clone(!0);if(t)s.data("current_time","000000").text(e).css("font-family","roboto_condensedregular"),changeDisplayText(s,"fancy");else if(""===e)$("#display-text").data("current_time","000000").text("Enter a time").css("font-family","roboto_condensedregular");else if("000000"===e)s.data("current_time","000000").text("0s").css("font-family","robotoregular"),changeDisplayText(s,"fancy");else if("Done"===e)s.data("current_time","000000").text(e).css("font-family","robotoregular"),changeDisplayText(s,"fancy");else if("Paused"===e)s=i.clone(!0).text(e).css("font-family","robotoregular"),changeDisplayText(s,"fancy");else if(i.data("current_time")!==e||"Paused"===i.text()){s.data("current_time",e).css("font-family","robotoregular");for(var o=[],l=["h","m","s"],n=0;3>n;n++){var c=e.slice(2*n,2*n+2);(c>0||o[0]||2===n)&&(10>c&&!o[0]&&(c=c.slice(-1)),o.push(c+l[n]))}var r=o.join(" ");s.text(r),changeDisplayText(s,a?"fancy":"")}}function startTimer(e){var t=getDisplayTime(),a=3600*t.slice(-6,-4),i=60*t.slice(-4,-2),s=1*t.slice(-2),o=a+i+s;if(36e4>o){var l=20;setTime(o,e),$("#display").data("input_mode",!1),$("#display").addClass("running"),e||($("#display").velocity("stop").velocity({height:"90%"},{duration:GLOBAL_ANIMATION_DURATION,easing:GLOBAL_EASE_OUT,delay:l}),$("#keypad").velocity("stop").velocity({scale:.8,opacity:0},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"none",delay:l}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"block",delay:l}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"block",delay:l}))}else setDisplayTime("Time too high",!0)}function editTime(){setDisplayTime(getDisplayTime()),$("#display").data("input_mode",!0).data("paused",!1),$("#display").removeClass("running"),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:GLOBAL_ANIMATION_DURATION,easing:GLOBAL_EASE_OUT}),$("#keypad").velocity("stop").velocity({scale:[1,.5],opacity:1},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:GLOBAL_EASE_OUT,display:"none",duration:GLOBAL_ANIMATION_DURATION}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function togglePause(){$("#display").data("paused")?resumeTimer():pauseTimer()}function pauseTimer(){$("#dial-ring path").velocity("stop"),setDisplayTime("Paused"),$("#display").data("paused",!0)}function resumeTimer(){startTimer(!0),$("#display").data("paused",!1)}function toggleKeyboardHelp(e){var t=$("#keyboard-help");if(arguments.length>0)!!t.data("shown")==!e&&toggleKeyboardHelp();else{var a=!t.data("shown");t.data("shown",a).velocity("stop").velocity({scale:a?[1,0]:[0,1],opacity:a?[1,0]:[0,1]},{easing:a?GLOBAL_EASE_OUT:GLOBAL_EASE_IN,display:a?"block":"none",duration:a?GLOBAL_ANIMATION_DURATION:GLOBAL_ANIMATION_DURATION/4})}}function toggleKeyboardSuggest(e){var t=$("#keyboard-suggest");if(arguments.length>0)!!t.data("shown")==!e&&toggleKeyboardSuggest();else{var a=!t.data("shown");a&&$.Velocity.hook(t,"translateY","-100%"),t.data("shown",a).velocity("stop").velocity({translateY:a?[0,"-100%"]:["-100%",0]},{easing:a?GLOBAL_EASE_OUT:GLOBAL_EASE_IN,display:a?"block":"none",duration:a?GLOBAL_ANIMATION_DURATION:GLOBAL_ANIMATION_DURATION/4})}}function changeDisplayText(e,t){$("#display-text-old").remove();var a=$("#display-text");if("fancy"===t){var i=a.text(),s=e.text(),o=[],l=[];if(i.length===s.length)for(var n=0;n<i.length;n++)i[n]===s[n]?(o.push(i[n]),l.push(s[n])):(o.push("<span>"),o.push(i[n]),o.push("</span>"),l.push("<span>"),l.push(s[n]),l.push("</span>"));else o.push("<span>"),o.push(i),o.push("</span>"),l.push("<span>"),l.push(s),l.push("</span>");a.attr("id","display-text-old").html(o.join("")).children("span").velocity({opacity:0,scale:.5},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,queue:!1,display:"inline-block",complete:function(){$(this).parent().remove()}}),e.html(l.join("")).appendTo("#display").children("span").css("opacity",0).velocity({opacity:[1,0],scale:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,queue:!1,display:"inline-block"})}else a.remove(),e.appendTo("#display")}function hoverTouchUnstick(){if("ontouchstart"in document.documentElement)for(var e=document.styleSheets.length-1;e>=0;e--){var t=document.styleSheets[e];if(t.cssRules)for(var a=t.cssRules.length-1;a>=0;a--){var i=t.cssRules[a];i.selectorText&&(i.selectorText=i.selectorText.replace(":hover",":active"))}}}var WHOLE_CIRCLE=.99999,EASE_FUNC="Expo",GLOBAL_EASE_OUT="easeOut"+EASE_FUNC,GLOBAL_EASE_IN="easeIn"+EASE_FUNC,GLOBAL_ANIMATION_DURATION=400;$(function(){FastClick.attach(document.body),$.Velocity.hook($("#keyboard-help"),"translateX","-50%"),$.Velocity.hook($("#keyboard-help"),"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("#keyboard-help > .shortcut.delete > span").text("Delete"),hoverTouchUnstick(),$("#display").data("input_mode",!0),startupAnimation(),setDisplayTime(""),$("#keypad td").click(function(){var e=$(this).text();if("Clear"==e)setDisplayTime("000000");else if("Start"==e)startTimer();else{var t=(getDisplayTime()+e).slice(-6);setDisplayTime(t)}}),$("#edit-button").click(editTime),$("#display-text").click(function(){$("#display").data("input_mode")||togglePause()}),$("#sure").click(function(){toggleKeyboardHelp(!0)}),$("#nope").click(function(){localStorage.setItem("mouse-suggested","temp")}),$("#keyboard-suggest .button").click(function(e){e.stopPropagation(),toggleKeyboardSuggest(!1)})}),$(document).on("keydown",function(e){var t=e.keyCode;switch(t){case 8:if(e.preventDefault(),$("#display").data("input_mode")){var a=("0"+getDisplayTime()).slice(-7,-1);setDisplayTime(a)}break;case 13:$("#display").data("input_mode")?startTimer():editTime();break;case 27:$("#display").data("input_mode")||editTime();break;case 32:$("#display").data("input_mode")?toggleKeyboardHelp():togglePause();break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if($("#display").data("input_mode")){var i=String.fromCharCode(t),s=(getDisplayTime()+i).slice(-6);setDisplayTime(s);break}}32!==t&&toggleKeyboardHelp(!1)}),$(document).on("touchstart",function(){localStorage.setItem("touch-device","true")}),$(document).click(function(){toggleKeyboardHelp(!1);var e=localStorage.getItem("touch-device"),t=localStorage.getItem("mouse-suggested"),a=sessionStorage.getItem("mouse-suggested");e||(t?"temp"===t&&(a||(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),toggleKeyboardSuggest(!0))):(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),toggleKeyboardSuggest(!0)))}),$(window).on("load resize orientationChange",function(){var e=Math.min($(window).height(),$(window).width());$("html").css("font-size",e/9)});