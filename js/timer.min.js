$(function(){"use strict";function a(a,c){var d=c?$("#dial-ring path").data("timeLeft"):1e3*a,e=c?$("#dial-ring path").data("progress"):0;$("#dial-ring path").velocity("stop").velocity({tween:[k,e]},{duration:d,easing:"linear",begin:function(){localStorage.setItem("timeStarted",(new Date).getTime()),localStorage.setItem("durationSet",d)},progress:function(a,c,d,e,f){b($("#dial-ring path"),40,f),$("#dial-ring path").data("progress",f),$("#dial-ring path").data("timeLeft",d);var g=Math.ceil(d/1e3),h=Math.floor(g/60)%60,i=Math.floor(g/3600),j=g%60;j=("0"+j).slice(-2),h=("0"+h).slice(-2),i=("0"+i).slice(-2);var k=[i,h,j];0!==d&&t.setTime(k.join(""),"crossfade")},complete:function(){t.setTime("Done","crossfade"),$("#display").removeClass("running"),localStorage.setItem("timeStarted",0),localStorage.setItem("durationSet",0)}})}function b(a,b,c){var d=50,e=d-b,f=c>=.5?1:0,g=e+b*(1+Math.sin(2*Math.PI*c)),h=e+b*(1-Math.cos(2*Math.PI*c)),i=g+" "+h,j=b+" "+b,k=" 0 "+f+" 1 ",l="M"+d+" "+d,m="m0 "+-b,n="A"+j+k+i,o=l+m+n;a.attr("d",o)}function c(){t.setTime(t.time,"crossfade"),$("#display").data("inputMode",!0).data("paused",!1).removeClass("running"),localStorage.setItem("timeStarted",0),localStorage.setItem("durationSet",0),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:o,easing:m}),$("#keypad").velocity("stop").velocity({scaleX:[1,.5],scaleY:1,opacity:1},{easing:m,duration:o,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:m,display:"none",duration:o,complete:function(){$.Velocity.hook($(this),"translateY","0")}}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function d(){$("#display").data("inputMode")||($("#display").data("paused")?(q.startTimer(!0),$("#display").data("paused",!1),$("#dial-ring").velocity("stop").velocity({opacity:1},{easing:m,duration:o})):$("#display").hasClass("running")?($("#dial-ring path").velocity("stop"),t.setTime("Paused","crossfade"),$("#display").data("paused",!0),$("#dial-ring").velocity("stop").velocity({opacity:.25},{easing:m,duration:o})):c())}function e(){if("ontouchstart"in document.documentElement)for(var a=document.styleSheets.length-1;a>=0;a--){var b=document.styleSheets[a];if(b.cssRules)for(var c=b.cssRules.length-1;c>=0;c--){var d=b.cssRules[c];d.selectorText&&(d.selectorText=d.selectorText.replace(":hover",":active"))}}}function f(a,b){b=b?b:window.location.search;var c=new RegExp("&amp;"+a+"=([^&amp;]*)","i");return b=(b=b.replace(/^\?/,"&amp;").match(c))?b[1]:""}function g(a){return a in document.body.style}var h,i,j,k=.99999,l="Expo",m="easeOut"+l,n="easeIn"+l,o=300,p=function(){var a={},b=a.hasOwnProperty;return{subscribe:function(c,d){b.call(a,c)||(a[c]=[]);var e=a[c].push(d)-1;return{remove:function(){delete a[c][e]}}},publish:function(c,d){b.call(a,c)&&a[c].forEach(function(a){a(void 0!=d?d:{})})}}}(),q=function(){function b(b,c){var d=t.time,e=3600*d.slice(-6,-4),f=60*d.slice(-4,-2),g=1*d.slice(-2),h=e+f+g;0!==h||b||c?36e4>h||c||b?(a(h,b||c),r.inputMode=!1,b||(r.expand(),s.shrink(),w.slideIn(),x.scaleIn())):(u.show("The time entered was too high. Enter a time less than 100 hours"),t.setTime("")):u.show("Please enter a time first")}var k=$(window),l=$(document);return FastClick.attach(document.body),e(),window.navigator.standalone&&l.on("touchmove",!1),(g("-webkit-backdrop-filter")||g("-moz-backdrop-filter")||g("-o-backdrop-filter")||g("-ms-backdrop-filter")||g("backdrop-filter"))&&$("body").addClass("backdrop-filter"),l.on("keydown",function(a){var b=a.keyCode;if(u.isShown){if(u.isEmpty){switch(b){case 13:u.clickButton("emphasize");break;case 27:u.clickButton("alert")}return!1}if(u.hide(),13===b)return!1}switch(b){case 8:if(a.preventDefault(),r.inputMode){var e=("0"+t.time).slice(-7,-1);t.setTime(e)}break;case 13:r.inputMode?q.startTimer():c();break;case 27:r.inputMode||c();break;case 32:r.inputMode?v.toggle():d();break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(r.inputMode){var f=String.fromCharCode(b);t.addDigit(f);break}}32!==b&&v.toggle(!1)}),l.on("touchstart",function(){localStorage.setItem("touch-device","true")}),k.on("load resize orientationChange",function(){h=k.width(),i=k.height();var a=Math.min(1.5*h,i);$.Velocity.hook($("html"),"fontSize",a/9+"px")}),l.click(function(a){$(a.target).hasClass("button")||v.toggle(!1);var b=localStorage.getItem("touch-device"),c=localStorage.getItem("mouse-suggested"),d=sessionStorage.getItem("mouse-suggested"),e="temp"===c,f=e&&!d;b||c&&!f||(localStorage.setItem("mouse-suggested","true"),sessionStorage.setItem("mouse-suggested","true"),u.show("Seems like you have a keyboard. Want to learn a few shortcuts?",[{text:"Never",style:"alert",clickFunction:function(){}},{text:"Not right now",style:"normal",clickFunction:function(){localStorage.setItem("mouse-suggested","temp")}},{text:"Yes, show me",style:"emphasize",clickFunction:function(){v.toggle(!0)}}]))}),p.subscribe("startup",function(){j=t.validateTime(f("time"))?"given":"normal"}),p.subscribe("startup.given",function(){t.setTime(("000000"+f("time")).slice(-6)),b()}),{startTimer:b}}(),r=function(){function a(){b.velocity("stop").velocity({height:"90%",translateY:0},{duration:o,easing:m})}var b=$("#display");return b.data("inputMode",!0),p.subscribe("startup.given",function(){$.Velocity.hook(b,"translateY","-100%")}),p.subscribe("startup.normal",function(){$.Velocity.hook(b,"height","100%"),b.velocity({height:"20%"},{easing:m,duration:o,complete:function(){function a(){return b+c-(new Date).getTime()}var b=parseInt(localStorage.getItem("timeStarted")),c=parseInt(localStorage.getItem("durationSet"));if(b&&c){var d=5;if(a()>1e3*d){var e="Seems like the timer was still running when you last closed this app. Do you want to restore the timer?",f={text:"No",style:"alert",clickFunction:function(){localStorage.setItem("timeStarted","0"),localStorage.setItem("durationSet","0")}},g={text:"Sure",style:"emphasize",clickFunction:function(){var b=1-a()/c;a()>0?($("#dial-ring path").data("timeLeft",a()).data("progress",b),q.startTimer(!1,!0)):u.show("Too late, the timer has already ended")}};u.show(e,[f,g])}}}})}),{expand:a,get inputMode(){return b.data("inputMode")},set inputMode(a){a?$("#display").data("inputMode",!0).removeClass("running"):$("#display").data("inputMode",!1).addClass("running")}}}(),s=function(){function a(){b.velocity("stop").velocity({scaleX:0,scaleY:0,opacity:0},{easing:m,duration:o,display:"none"})}var b=$("#keypad");return $.Velocity.hook(b,"translateX","-50%"),$.Velocity.hook(b,"scaleX",.5),$.Velocity.hook(b,"scaleY",0),$.Velocity.hook(b,"opacity",0),b.on("click","td",function(){var a=$(this).text();"Clear"===a?t.setTime(""):"Start"===a?q.startTimer():t.addDigit(a)}),p.subscribe("startup.normal",function(){b.velocity({opacity:1,scaleX:1,scaleY:1},{easing:m,duration:o})}),{shrink:a}}(),t=function(){function a(a){var b=3600*a.slice(-6,-4),c=60*a.slice(-4,-2),d=1*a.slice(-2),e=b+c+d;return e>0&&36e4>e}function b(a,b){var c=!1,d="",f="1rem",g="",j=$("#display-text").clone(!0).attr("id","display-text-old");switch(a){case"000000":case"":a="0s";case"Done":g="000000";case"Paused":d=a,c=!0;break;default:if(e.data("currentTime")!==a||"Paused"===e.text()){for(var k=[],l=["h","m","s"],n=0;3>n;n++){var p=a.slice(2*n,2*n+2);(p>0||k[0]||2===n)&&(10>p&&!k[0]&&(p=p.slice(-1)),k.push(p+l[n]))}var q=k.join(" ");if(.9*i>h&&q.length>8){if(1.5*h>i){var r=1/.9,s=1.5,t=i/h,u=(s-t)/(s-r);f=8/q.length*(1-u)+u}else f=8/q.length;f+="rem"}g=a,d=q,c=!0}}if(c){if($("#display-text-old").remove(),"crossfade"===b){var v=$("#display-text").text(),w=d,x="",y="";if(v.length===w.length)for(var z=0;z<v.length;z++)v[z]===w[z]?(x+=v[z],y+=w[z]):(x+="<span>"+v[z]+"</span>",y+="<span>"+w[z]+"</span>");else x="<span>"+v+"</span>",y="<span>"+w+"</span>";var A=/<\/span><span>/gi;j.html(x.replace(A,"").replace(" ","&nbsp;")).children("span").velocity({opacity:[0,1],scale:0},{easing:m,duration:Math.min(o,1e3),queue:!1,display:"inline-block",complete:function(){$(this).parent().remove()}}).end().prependTo(e.parent()),e.html(y.replace(A,"").replace(" ","&nbsp;")).css({fontFamily:"robotoregular"}).children("span").css("opacity",0).velocity({opacity:1,scale:[1,0]},{easing:m,duration:Math.min(o,1e3),queue:!1,display:"inline-block",complete:function(){$(this).contents().unwrap()}})}else e.css({fontFamily:"robotoregular"}).html(d);e.data("currentTime",g).add(j).velocity({fontSize:f},{easing:m,duration:o,queue:!1})}}function c(a){b((e.data("currentTime")+a).slice(-6))}var e=$("#display-text");return e.data("currentTime","000000"),$.Velocity.hook(e,"translateX","-50%"),$.Velocity.hook(e,"translateY","-50%"),e.click(d),p.subscribe("startup.normal",function(){$.Velocity.hook(e,"opacity",0),e.velocity({opacity:1},{easing:m,duration:o})}),{addDigit:c,setTime:b,validateTime:a,get time(){return e.data("currentTime")}}}(),u=function(){function a(a,b){f.text(a);var c=f.siblings("div").empty();if(b){$("#content").css("pointer-events","none");for(var g=b.length-1;g>=0;g--){var h=b[g];$("<div></div>").text(h.text).addClass(h.style+" button").click(h.clickFunction).prependTo(c)}}else clearTimeout(d),d=setTimeout(u.hide,5e3);e.velocity("stop").velocity({translateY:e.data("shown")?0:[0,"-100%"]},{easing:m,display:"block",duration:o,complete:function(){b?$("#content").on("click.bannerhide",u.hide):$(document).on("click.bannerhide",u.hide)}}).data("shown",!0)}function b(){$(document).off("click.bannerhide",u.hide),$("#content").off("click.bannerhide",u.hide).css("pointer-events",""),e.data("shown")&&e.data("shown",!1).velocity("stop").velocity({translateY:"-100%"},{easing:n,display:"none",duration:o/2})}function c(a){e.find("."+a).click()}var d,e=$("#notification-banner"),f=e.find("span");return e.on("click",".button",b),{show:a,hide:b,clickButton:c,get isShown(){return e.data("shown")},get isEmpty(){return""!==e.find("div").text()}}}(),v=function(){function a(c){if(0===arguments.length){var d=!b.data("shown");b.data("shown",d).velocity("stop").velocity({scaleY:d?[1,0]:[0,1],scaleX:d?[1,.5]:[0,1],opacity:d?[1,0]:[0,1]},{easing:d?m:n,display:d?"block":"none",duration:d?o:o/2})}else(b.data("shown")||!1)!==c&&a()}var b=$("#keyboard-help");return $.Velocity.hook(b,"translateX","-50%"),$.Velocity.hook(b,"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&b.find(".delete").text("Delete"),{toggle:a}}(),w=function(){function a(){b.velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:m,duration:o,display:"block"})}var b=$("#edit-button");return b.click(c),{slideIn:a}}(),x=function(){function a(){b.velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:m,duration:o,display:"block"})}var b=$("#dial-ring");return{scaleIn:a}}();p.publish("startup"),p.publish("startup."+j)});
//# sourceMappingURL=timer.min.js.map