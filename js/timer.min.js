"use strict";function startupAnimation(){var e=400;$("#display-text").velocity({translateY:["-50%","-100%"]},{easing:"easeOutExpo",duration:2*e}),$("#display").velocity({translateY:[0,"-100%"]},{easing:"easeOutExpo",duration:2*e});var t=$("#keypad tr");$.Velocity.hook(t,"opacity","0"),$.Velocity.RegisterEffect("transition.slideIn",{calls:[[{translateY:[0,"-10%"],opacity:[1,0]}]]}),t.velocity("transition.slideIn",{easing:"easeOutExpo",duration:e,delay:e/2,stagger:e/2/(t.length-1),drag:!0,display:null})}function setDial(e,t,i){var a=50,o=a-t,s=i>=.5?1:0,l=o+t*(1+Math.sin(2*Math.PI*i)),n=o+t*(1-Math.cos(2*Math.PI*i)),r=l+" "+n,d=t+" "+t,c=" 0 "+s+" 1 ",p="M"+a+" "+a,y="m0 "+-t,u="A"+d+c+r,m=p+y+u;e.attr("d",m)}function setTime(e){var t=1e3*e;$("#dial-ring path").velocity({tween:WHOLE_CIRCLE},{duration:t,easing:"linear",progress:function(e,t,i,a,o){setDial($("#dial-ring path"),40,o);var s=Math.ceil(i/1e3),l=Math.floor(s/60)%60,n=Math.floor(s/3600),r=s%60;r=("0"+r).slice(-2),l=("0"+l).slice(-2),n=("0"+n).slice(-2);var d=[n,l,r];setDisplayTime(d.join(""),!1)},complete:function(){setDisplayTime("Done")}})}function getDisplayTime(e){var t=$("#display-text");return e?t.text():t.data("current_time")}function setDisplayTime(e,t){var i=$("#display-text");if(t)i.data("current_time","000000").text(e).css("font-family","roboto_condensedregular");else if(""===e)i.data("current_time","000000").text("Enter a time").css("font-family","roboto_condensedregular");else if("000000"===e)i.data("current_time","000000").text("0s").css("font-family","robotoregular");else if("Done"===e)i.data("current_time","000000").text("Done").css("font-family","robotoregular");else if(i.data("current_time")!==e){i.data("current_time",e).css("font-family","robotoregular");for(var a=getDisplayTime(),o=[],s=["h","m","s"],l=0;3>l;l++){var n=a.slice(2*l,2*l+2);(n>0||o[0]||2===l)&&(10>n&&!o[0]&&(n=n.slice(-1)),o.push(n+s[l]))}var r=o.join(" ");i.text(r)}}function startTimer(){var e=getDisplayTime(),t=3600*e.slice(-6,-4),i=60*e.slice(-4,-2),a=1*e.slice(-2),o=t+i+a;36e4>o?(setTime(o),$("#display").data("input_mode",!1),$("#display").velocity("stop").velocity({translateY:0,height:"90%"},{duration:400,easing:"easeOutExpo"}),$("#keypad").velocity("stop").velocity({translateY:"10%",opacity:0},{easing:"easeOutExpo",duration:400,display:"none"}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:"easeOutExpo",duration:400,display:"block"}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:"easeOutExpo",duration:400,display:"block"})):setDisplayTime("Time too high",!0)}function editTime(){setDisplayTime(getDisplayTime()),$("#display").data("input_mode",!0),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:400,easing:"easeOutExpo"}),$("#keypad").velocity("stop").velocity({translateY:0,opacity:1},{easing:"easeOutExpo",duration:400,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:"easeOutExpo",display:"none",duration:400}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function toggleKeyboardHelp(e){var t=$("#keyboard-help");if(e)t.data("shown")&&toggleKeyboardHelp();else{var i;i=t.data("shown")?!1:!0,t.data("shown",i).velocity("stop").velocity({scale:i?[1,0]:[0,1],opacity:i?[1,0]:[0,1]},{easing:i?"easeOutExpo":"easeInExpo",display:i?"block":"none",duration:i?400:100})}}function hoverTouchUnstick(){if("ontouchstart"in document.documentElement)for(var e=document.styleSheets.length-1;e>=0;e--){var t=document.styleSheets[e];if(t.cssRules)for(var i=t.cssRules.length-1;i>=0;i--){var a=t.cssRules[i];a.selectorText&&(a.selectorText=a.selectorText.replace(":hover",":active"))}}}var WHOLE_CIRCLE=.99999999;$(function(){$.Velocity.hook($("#keyboard-help"),"translateX","-50%"),$.Velocity.hook($("#keyboard-help"),"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("#keyboard-help > .shortcut.delete > span").text("Delete"),hoverTouchUnstick(),$("#display").data("input_mode",!0),startupAnimation(),setDisplayTime(""),$("#keypad td").on("tap",function(){var e=$(this).text();if("Clear"==e)setDisplayTime("000000");else if("Start"==e)startTimer();else{var t=(getDisplayTime()+e).slice(-6);setDisplayTime(t)}}),$("#edit-button").on("tap",function(){editTime()}),$("#keyboard-help").on("tap",function(){toggleKeyboardHelp(!0)}),$(document).on("keydown",function(e){var t=e.keyCode;if(t>=48&&57>=t){$("#display").data("input_mode")||editTime();var i=String.fromCharCode(t),a=(getDisplayTime()+i).slice(-6);setDisplayTime(a)}else if(13===t)$("#display").data("input_mode")?startTimer():editTime();else if(8===t){e.preventDefault(),$("#display").data("input_mode")||editTime();var o=("0"+getDisplayTime()).slice(-7,-1);setDisplayTime(o)}else 27!==t||$("#display").data("input_mode")||editTime();32===t?toggleKeyboardHelp():toggleKeyboardHelp(!0)})}),$(window).on("load resize orientationChange",function(){var e=Math.min($(window).height(),$(window).width());$("html").css("font-size",e/9)});