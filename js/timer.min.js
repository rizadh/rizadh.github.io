"use strict";function startupAnimation(){var e=GLOBAL_ANIMATION_DURATION,t=$("#display-text"),a=$("#display"),i=$("#keypad tr"),o=20;$.Velocity.hook(t,"translateY","-100%"),$.Velocity.hook(t,"opacity","0"),t.velocity({translateY:"-50%",opacity:1},{easing:GLOBAL_EASE_OUT,duration:e,delay:o}),$.Velocity.hook(a,"translateY","-100%"),$.Velocity.hook(a,"opacity","0"),a.velocity({translateY:0,opacity:1},{easing:GLOBAL_EASE_OUT,duration:e,delay:o}),$.Velocity.hook(i,"opacity","0"),$.Velocity.hook(i,"translateY","-10%"),$.Velocity.RegisterEffect("transition.slideIn",{calls:[[{translateY:0,opacity:1}]]}),i.velocity("transition.slideIn",{easing:GLOBAL_EASE_OUT,duration:e/2,delay:e/4+o,stagger:e/4/(i.length-1),drag:!0,display:null})}function setDial(e,t,a){var i=50,o=i-t,s=a>=.5?1:0,l=o+t*(1+Math.sin(2*Math.PI*a)),n=o+t*(1-Math.cos(2*Math.PI*a)),r=l+" "+n,c=t+" "+t,d=" 0 "+s+" 1 ",y="M"+i+" "+i,p="m0 "+-t,u="A"+c+d+r,m=y+p+u;e.attr("d",m)}function setTime(e,t){var a=$("#dial-ring path"),i=t?a.data("time_left"):1e3*e,o=t?a.data("progress"):0;a.velocity({tween:[WHOLE_CIRCLE,o]},{duration:i,easing:"linear",progress:function(e,t,i,o,s){setDial(a,40,s),a.data("progress",s),a.data("time_left",i);var l=Math.ceil(i/1e3),n=Math.floor(l/60)%60,r=Math.floor(l/3600),c=l%60;c=("0"+c).slice(-2),n=("0"+n).slice(-2),r=("0"+r).slice(-2);var d=[r,n,c];setDisplayTime(d.join(""),!1)},complete:function(){setDisplayTime("Done")}})}function getDisplayTime(e){var t=$("#display-text");return e?t.text():t.data("current_time")}function setDisplayTime(e,t){var a=$("#display-text");if(t)a.data("current_time","000000").text(e).css("font-family","roboto_condensedregular");else if(""===e)a.data("current_time","000000").text("Enter a time").css("font-family","roboto_condensedregular");else if("000000"===e)a.data("current_time","000000").text("0s").css("font-family","robotoregular");else if("Done"===e)a.data("current_time","000000").text("Done").css("font-family","robotoregular");else if(a.data("current_time")!==e){a.data("current_time",e).css("font-family","robotoregular");for(var i=getDisplayTime(),o=[],s=["h","m","s"],l=0;3>l;l++){var n=i.slice(2*l,2*l+2);(n>0||o[0]||2===l)&&(10>n&&!o[0]&&(n=n.slice(-1)),o.push(n+s[l]))}var r=o.join(" ");a.text(r)}}function startTimer(e){var t=getDisplayTime(),a=3600*t.slice(-6,-4),i=60*t.slice(-4,-2),o=1*t.slice(-2),s=a+i+o;if(36e4>s){var l=20;setTime(s,e),$("#display").data("input_mode",!1),$("#display").addClass("running"),e||($("#display").velocity("stop").velocity({height:"90%"},{duration:GLOBAL_ANIMATION_DURATION,easing:GLOBAL_EASE_OUT,delay:l}),$("#keypad").velocity("stop").velocity({translateY:"10%",opacity:0},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"none",delay:l}),$("#edit-button").velocity("stop").velocity({translateY:[0,"100%"],opacity:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"block",delay:l}),$("#dial-ring").velocity("stop").velocity({opacity:[1,0],scale:[1,0]},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"block",delay:l}))}else setDisplayTime("Time too high",!0)}function editTime(){setDisplayTime(getDisplayTime()),$("#display").data("input_mode",!0),$("#display").removeClass("running"),$("#dial-ring path").velocity("stop"),$("#display").velocity("stop").velocity({height:"20%"},{duration:GLOBAL_ANIMATION_DURATION,easing:GLOBAL_EASE_OUT}),$("#keypad").velocity("stop").velocity({translateY:0,opacity:1},{easing:GLOBAL_EASE_OUT,duration:GLOBAL_ANIMATION_DURATION,display:"table"}),$("#edit-button").velocity("stop").velocity({opacity:0,translateY:"-700%"},{easing:GLOBAL_EASE_OUT,display:"none",duration:GLOBAL_ANIMATION_DURATION}),$("#dial-ring").velocity("stop").velocity("fadeOut",100)}function togglePause(){$("#dial-ring path").data("paused")?resumeTimer():pauseTimer()}function pauseTimer(){var e=$("#dial-ring path");e.velocity("stop"),setDisplayTime("PAUSED",!0),e.data("paused",!0)}function resumeTimer(){var e=$("#dial-ring path");startTimer(!0),e.data("paused",!1)}function toggleKeyboardHelp(e){var t=$("#keyboard-help");if(e)t.data("shown")&&toggleKeyboardHelp();else{var a;a=t.data("shown")?!1:!0,t.data("shown",a).velocity("stop").velocity({scale:a?[1,0]:[0,1],opacity:a?[1,0]:[0,1]},{easing:a?GLOBAL_EASE_OUT:GLOBAL_EASE_IN,display:a?"block":"none",duration:a?GLOBAL_ANIMATION_DURATION:GLOBAL_ANIMATION_DURATION/4})}}function hoverTouchUnstick(){if("ontouchstart"in document.documentElement)for(var e=document.styleSheets.length-1;e>=0;e--){var t=document.styleSheets[e];if(t.cssRules)for(var a=t.cssRules.length-1;a>=0;a--){var i=t.cssRules[a];i.selectorText&&(i.selectorText=i.selectorText.replace(":hover",":active"))}}}var WHOLE_CIRCLE=.99999,EASE_FUNC="Expo",GLOBAL_EASE_OUT="easeOut"+EASE_FUNC,GLOBAL_EASE_IN="easeIn"+EASE_FUNC,GLOBAL_ANIMATION_DURATION=400;$(function(){$.Velocity.hook($("#keyboard-help"),"translateX","-50%"),$.Velocity.hook($("#keyboard-help"),"translateY","-50%"),navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("#keyboard-help > .shortcut.delete > span").text("Delete"),hoverTouchUnstick(),$("#display").data("input_mode",!0),startupAnimation(),setDisplayTime(""),$("#keypad td").on("tap",function(){var e=$(this).text();if("Clear"==e)setDisplayTime("000000");else if("Start"==e)startTimer();else{var t=(getDisplayTime()+e).slice(-6);setDisplayTime(t)}}),$("#edit-button").on("tap",function(){editTime()}),$("#display").on("tap",function(){$("#display").data("input_mode")||togglePause()})}),$(document).on("keydown",function(e){var t=e.keyCode;switch(t){case 8:e.preventDefault(),$("#display").data("input_mode")||editTime();var a=("0"+getDisplayTime()).slice(-7,-1);setDisplayTime(a);break;case 13:$("#display").data("input_mode")?startTimer():editTime();break;case 27:$("#display").data("input_mode")||editTime();break;case 32:$("#display").data("input_mode")?toggleKeyboardHelp():togglePause();break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:$("#display").data("input_mode")||editTime();var i=String.fromCharCode(t),o=(getDisplayTime()+i).slice(-6);setDisplayTime(o)}32!==t&&toggleKeyboardHelp(!0)}),$(document).on("click",function(){toggleKeyboardHelp(!0)}),$(window).on("load resize orientationChange",function(){var e=Math.min($(window).height(),$(window).width());$("html").css("font-size",e/9)});